# Babylon.js Windmill Viewer Documentation

This document provides comprehensive documentation for the Babylon.js Windmill Viewer project. The application displays a 3D windmill model using Babylon.js and is served by a simple Express backend.

## Project Structure

```
/Users/frederic/fax/src/proto/babylon-js-windmill
├── dist/
│   ├── app.bundle.js
│   └── server.bundle.js
├── docs/
│   └── README.md
├── node_modules/
├── src/
│   ├── app.ts
│   └── server.ts
├── assets/
│   └── windmill.glb  # Example asset, confirm actual asset paths
├── index.html
├── package.json
├── package-lock.json
├── tsconfig.json
├── webpack.config.js
└── .env               # Optional: for environment variables like PORT
```

- **dist/**: Contains the bundled JavaScript files generated by Webpack.
- **docs/**: Contains project documentation.
- **node_modules/**: Contains project dependencies.
- **src/**: Contains the TypeScript source code.
  - `app.ts`: Frontend Babylon.js application logic.
  - `server.ts`: Backend Express server logic.
- **assets/**: Contains 3D models and other static assets.
- `index.html`: The main HTML file that loads the Babylon.js canvas and application script.
- `package.json`: Lists project dependencies and scripts.
- `package-lock.json`: Records exact versions of dependencies.
- `tsconfig.json`: TypeScript compiler configuration.
- `webpack.config.js`: Webpack bundler configuration.
- `.env` (Optional): Environment variables (e.g., `PORT=8080`).

## Setup Instructions

1.  **Clone the repository:**
    ```bash
    git clone <repository-url>
    cd babylon-js-windmill
    ```
2.  **Install dependencies:**
    ```bash
    npm install
    ```

## Build and Run Commands

-   **Build the project:** Compiles TypeScript and bundles the application using Webpack.
    ```bash
    npm run build
    ```
-   **Run the development server:** Builds the project and starts the server using `nodemon` for automatic restarts on file changes.
    ```bash
    npm run dev
    ```
-   **Start the production server:** Runs the pre-built application.
    ```bash
    npm start
    ```

    Access the application in your browser, typically at `http://localhost:8000` (or the port specified in `.env` or the default in `server.ts`).

## Code Explanation

### `src/app.ts`

This file contains the client-side code responsible for rendering the 3D scene using Babylon.js.

-   **Initialization**: Sets up the Babylon.js engine and scene, attaching it to the HTML canvas element (`#renderCanvas`).
-   **Camera**: Configures an `ArcRotateCamera` for user interaction (orbiting, zooming).
-   **Lighting**: Adds a `HemisphericLight` to illuminate the scene.
-   **Model Loading**: Uses `SceneLoader` to import the windmill model (e.g., `windmill.glb`) from the `/assets` directory and adds it to the scene.
-   **Render Loop**: Starts the engine's render loop to continuously draw the scene.

### `src/server.ts`

This file sets up a simple backend server using Express.js.

-   **Dependencies**: Imports `express` and `path`.
-   **Middleware**: Uses `express.static` to serve static files from the project root (including `index.html`, bundled JS, and assets).
-   **Environment Variables**: Optionally uses `dotenv` to load environment variables (like `PORT`) from a `.env` file.
-   **Port Configuration**: Sets the server port, defaulting to 8000 if `process.env.PORT` is not set.
-   **Server Start**: Starts the Express server and logs the listening address.

## Dependencies

### Production Dependencies

-   `@babylonjs/core`: Core Babylon.js library for 3D rendering.
-   `@babylonjs/loaders`: Babylon.js loaders for various 3D model formats (e.g., glTF/GLB).
-   `express`: Web framework for the backend server.
-   `dotenv`: Loads environment variables from a `.env` file.

### Development Dependencies

-   `typescript`: TypeScript compiler.
-   `@types/express`: Type definitions for Express.
-   `@types/node`: Type definitions for Node.js.
-   `webpack`: Module bundler.
-   `webpack-cli`: Command-line interface for Webpack.
-   `ts-loader`: Webpack loader for TypeScript files.
-   `webpack-node-externals`: Excludes Node.js built-in modules from the Webpack bundle for the backend.
-   `nodemon`: Utility that automatically restarts the server during development when file changes are detected.

## Future Development

This project serves as a foundation. Future enhancements could include:

-   Adding more complex interactions or animations to the windmill.
-   Implementing unit or integration tests.
-   Setting up a more robust deployment pipeline.
-   Improving error handling and logging.
